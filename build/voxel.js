window.voxelcss={},window.voxelcss.interfaces={},function(){function t(t){function n(t,n){t="on"+t,"function"==typeof n&&(i[t]||(i[t]=[]),i[t].indexOf(n)>-1||i[t].push(n))}function e(t,n){t="on"+t,i[t]&&i[t].splice(i[t].indexOf(n),1)}function r(t,n){t="on"+t;var e=i[t];if(e)for(var r,o=0;r=e[o++];)r(n)}var o=t||new Function,i={};return o.addEventListener=n,o.removeEventListener=e,o.triggerEvent=r,o}voxelcss.interfaces.EventListener=t}(),function(){function t(t){function n(t,n,i){g=!1;var a={x:e(t),y:r(n),z:o(i)};return g=!0,l.triggerEvent("move"),a}function e(t){if(void 0===t||"number"!=typeof t)return m.x;var n=m.x;return m.x=t,g&&l.triggerEvent("move"),n}function r(t){if(void 0===t||"number"!=typeof t)return m.y;var n=m.y;return m.y=t,g&&l.triggerEvent("move"),n}function o(t){if(void 0===t||"number"!=typeof t)return m.z;var n=m.z;return m.z=t,g&&l.triggerEvent("move"),n}function i(t,n,e){g=!1;var r={x:a(t),y:u(n),z:c(e)};return g=!0,l.triggerEvent("move"),r}function a(t){return void 0===t||"number"!=typeof t?m.x:e(t+m.x)}function u(t){return void 0===t||"number"!=typeof t?m.y:r(t+m.y)}function c(t){return void 0===t||"number"!=typeof t?m.z:o(t+m.z)}function s(){return{x:m.x,y:m.y,z:m.z}}function f(){return m.x}function v(){return m.y}function d(){return m.z}var l=t||new Function,m={x:0,y:0,z:0},g=!0;return l.setPosition=n,l.setPositionX=e,l.setPositionY=r,l.setPositionZ=o,l.translate=i,l.translateX=a,l.translateY=u,l.translateZ=c,l.getPosition=s,l.getPositionX=f,l.getPositionY=v,l.getPositionZ=d,l}voxelcss.interfaces.Positioned=t}(),function(){function t(){function t(t){if(t!==w)for(var n in P){var e=t[n];if(e!==w)if(S[n]=e,P[n]!==w&&P[n].SyncedGif!==w&&P[n].SyncedGif.detach(P[n]),e instanceof Array){var r=new voxelcss.SyncedGif(e,320);r.attach(P[n]),P[n].SyncedGif=r}else P[n].src=e}}function n(){return S}function e(t){if(t===w)throw"Scene required to add voxel to scene";C=t,L.setAttribute("class","anim up"),m()}function r(t){if(t===w)throw"Scene required to add voxel to scene";C=t,L.setAttribute("class","anim down"),m()}function o(t){if(t===w)throw"Scene required to add voxel to scene";C=t,L.setAttribute("class","anim"),m()}function i(){C!==w&&C.removeChild(A)}function a(t){if(t===w||"number"!=typeof t)return D;var n=D;return D=t,n}function u(){return D}function c(){return A}function s(){return new voxelcss.Voxel(z.getPositionX(),z.getPositionY(),z.getPositionZ(),D,{mesh:S})}function f(){A=d("div","cube"),L=d("div","anim"),v("top"),v("bottom"),v("front"),v("back"),v("left"),v("right"),A.appendChild(L)}function v(t){var n=d("div","face "+t);switch(n.style.width=D+"px",n.style.height=D+"px",n.style.marginLeft=-D/2+"px",n.style.marginTop=-D/2+"px",t){case"top":n.style.transform="rotateX(90deg) translate3d(0, 0,  "+D/2+"px)",n.addEventListener("click",y);break;case"bottom":n.style.transform="rotateX(90deg) translate3d(0, 0, -"+D/2+"px)",n.addEventListener("click",p);break;case"left":n.style.transform="rotateY(90deg) translate3d(0, 0, -"+D/2+"px)",n.addEventListener("click",x);break;case"right":n.style.transform="rotateY(90deg) translate3d(0, 0,  "+D/2+"px)",n.addEventListener("click",h);break;case"front":n.style.transform="translate3d(0, 0,  "+D/2+"px)",n.addEventListener("click",E);break;case"back":n.style.transform="translate3d(0, 0, -"+D/2+"px)",n.addEventListener("click",b)}n.addEventListener("contextmenu",g);var e=d("img","");P[t]=e,n.appendChild(e),L.appendChild(n)}function d(t,n){var e=document.createElement(t);return e.setAttribute("class",n),e}function l(){var t=z.getPosition();A.style.transform="translate3d("+t.x+"px, "+-t.y+"px, "+t.z+"px)"}function m(){C.add(z)}function g(t){return t.preventDefault(),z.triggerEvent("VoxelClick",{target:z}),!1}function y(){z.triggerEvent("TopClick",{target:z})}function p(){z.triggerEvent("BottomClick",{target:z})}function x(){z.triggerEvent("LeftClick",{target:z})}function h(){z.triggerEvent("RightClick",{target:z})}function E(){z.triggerEvent("FrontClick",{target:z})}function b(){z.triggerEvent("BackClick",{target:z})}var w,z=this;const k="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";var A,L,C,P={},S={},D=0;z.setMesh=t,z.getMesh=n,z.animUp=e,z.animDown=r,z.addToScene=o,z.removeFromScene=i,z.setDimension=a,z.getDimension=u,z.getDomElement=c,z.clone=s,function(n,e,r,o,i){voxelcss.interfaces.Positioned(voxelcss.interfaces.EventListener(z)),z.addEventListener("move",l),a(o),f(),z.setPosition(n,e,r),t({top:k,bottom:k,front:k,back:k,left:k,right:k}),i!==w&&i.mesh!==w&&t(i.mesh)}.apply(z,arguments)}voxelcss.Voxel=t}(),function(){function t(){function t(t,o,i){return{x:n(t),y:e(o),z:r(i)}}function n(t){if(t===$||"number"!=typeof t)return it.x;var n=it.x;return it.x+=t,K(),n}function e(t){if(t===$||"number"!=typeof t)return it.y;var n=it.y;return it.y+=t,K(),n}function r(t){if(t===$||"number"!=typeof t)return it.z;var n=it.z;return it.z+=t,K(),n}function o(t,n,e){var r={x:i(t),y:a(n),z:u(e)};return K(),r}function i(t){if(t===$||"number"!=typeof t)return it.x;var n=it.x;return it.x=t,K(),n}function a(t){if(t===$||"number"!=typeof t)return it.y;var n=it.y;return it.y=t,K(),n}function u(t){if(t===$||"number"!=typeof t)return it.z;var n=it.z;return it.z=t,K(),n}function c(){return{x:it.x,y:it.y,z:it.z}}function s(){return it.x}function f(){return it.y}function v(){return it.z}function d(t,n,e){return{x:l(t),y:m(n),z:g(e)}}function l(t){if(t===$||"number"!=typeof t)return at.x;var n=at.x;return at.x+=t,K(),n}function m(t){if(t===$||"number"!=typeof t)return at.y;var n=at.y;return at.y+=t,K(),n}function g(t){if(t===$||"number"!=typeof t)return at.z;var n=at.z;return at.z+=t,K(),n}function y(t,n,e){var r={x:p(t),y:x(n),z:h(e)};return K(),r}function p(t){if(t===$||"number"!=typeof t)return at.x;var n=at.x;return at.x=t,K(),n}function x(t){if(t===$||"number"!=typeof t)return at.y;var n=at.y;return at.y=t,K(),n}function h(t){if(t===$||"number"!=typeof t)return at.z;var n=at.z;return at.z=t,K(),n}function E(){return{x:at.x,y:at.y,z:at.z}}function b(){return at.x}function w(){return at.y}function z(){return at.z}function k(t){if(t===$||"number"!=typeof t)return ut;var n=ut;return ut+=t,K(),n}function A(t){if(t===$||"number"!=typeof t)return ut;return ut=t,K(),ut}function L(){return ut}function C(t){if(ot)throw"Cannot attach currently attached scene";_=t,t.appendChild(tt),ot=!0}function P(){if(!ot)throw"Cannot detach currently detached scene";ot=!1,tt.parentElement.removeChild(tt)}function S(){return ot}function D(){return _}function Z(){st||(st=!0)}function M(){st&&(st=!1)}function Y(){return st}function R(){ft||(ft=!0)}function X(){ft&&(ft=!1)}function B(){return ft}function I(){vt||(vt=!0)}function O(){vt&&(vt=!1)}function T(){return vt}function V(t){et.appendChild(t.getDomElement())}function F(t){et.removeChild(t.getDomElement())}function G(){tt=document.createElement("div"),tt.setAttribute("class","scene"),nt=document.createElement("div"),nt.setAttribute("class","zoom"),et=document.createElement("div"),et.setAttribute("class","camera"),tt.appendChild(nt),nt.appendChild(et)}function W(){tt.addEventListener("mousedown",q),tt.addEventListener("mousewheel",N)}function q(t){ct.start.x=t.x,ct.start.y=t.y,ct.current.x=t.x,ct.current.y=t.y,window.addEventListener("mousemove",J),window.addEventListener("mouseup",H)}function H(t){window.removeEventListener("mousemove",J),window.removeEventListener("mouseup",H)}function J(t){if(ct.lastMove.dx=t.x-ct.current.x,ct.lastMove.dy=t.y-ct.current.y,ct.current.x=t.x,ct.current.y=t.y,ft&&ct.shiftDown)d(ct.lastMove.dx,ct.lastMove.dy),K(),rt.triggerEvent("pan",{rotation:c(),pan:E(),zoom:L(),target:rt});else if(st){const n=2;it.y+=ct.lastMove.dx/window.innerWidth*Math.PI*2*n,it.x-=ct.lastMove.dy/window.innerHeight*Math.PI*2*n,K(),rt.triggerEvent("orbit",{rotation:c(),pan:E(),zoom:L(),target:rt})}}function N(t){return vt?(ut+=t.deltaY/5e3,K(),t.preventDefault(),rt.triggerEvent("zoom",{rotation:c(),pan:E(),zoom:L(),target:rt}),!1):void 0}function Q(){window.addEventListener("keydown",U),window.addEventListener("keyup",j)}function U(t){(16===t.keyCode||16===t.which)&&(ct.shiftDown=!0)}function j(t){(16===t.keyCode||16===t.which)&&(ct.shiftDown=!1)}function K(){et.style.transform="rotateX("+it.x+"rad) rotateY("+it.y+"rad) rotateZ("+it.z+"rad)",nt.style.transform="scale("+ut+", "+ut+")",nt.style.transform+=" translateX("+at.x+"px) translateY("+at.y+"px) translateZ("+at.z+"px)"}var $,_,tt,nt,et,rt=this,ot=!1,it={x:0,y:0,z:0},at={x:0,y:0,z:0},ut=1,ct={start:{x:0,y:0},current:{x:0,y:0},lastMove:{x:0,y:0},shiftDown:!1},st=!0,ft=!0,vt=!0;rt.rotate=t,rt.rotateX=n,rt.rotateY=e,rt.rotateZ=r,rt.setRotation=o,rt.setRotationX=i,rt.setRotationY=a,rt.setRotationZ=u,rt.getRotation=c,rt.getRotationX=s,rt.getRotationY=f,rt.getRotationZ=v,rt.pan=d,rt.panX=l,rt.panY=m,rt.panZ=g,rt.setPan=y,rt.setPanX=p,rt.setPanY=x,rt.setPanZ=h,rt.getPan=E,rt.getPanX=b,rt.getPanY=w,rt.getPanZ=z,rt.zoom=k,rt.setZoom=A,rt.getZoom=L,rt.attach=C,rt.detach=P,rt.isAttached=S,rt.getParentElement=D,rt.enableOrbit=Z,rt.disableOrbit=M,rt.canOrbit=Y,rt.enablePan=R,rt.disablePan=X,rt.canPan=B,rt.enableZoom=I,rt.disableZoom=O,rt.canZoom=T,rt.add=V,rt.remove=F,function(){voxelcss.interfaces.EventListener(rt),G(),W(),Q()}.apply(rt,arguments)}voxelcss.Scene=t}(),function(){function t(){function t(t){return y.push(t),l.add(t)}function n(t){var n=y.indexOf(t);return-1==n?!1:(l.remove(t),y.splice(n,1),!0)}function e(){for(var t,n=[],e=0;t=y[e++];)n.push({position:t.getPosition(),dimension:t.getDimension(),mesh:t.getMesh()});return JSON.stringify(n)}function r(n){f();for(var e,r=JSON.parse(n+""),o=0;e=r[o++];){var i=new voxelcss.Voxel(e.position.x,e.position.y,e.position.z,e.dimension);i.setMesh(e.mesh),t(i)}}function o(){localStorage.setItem(v(),e())}function i(){r(localStorage.getItem(v())||"[]")}function a(){return!!localStorage.getItem(v())}function u(){localStorage.setItem(v(),"")}function c(){return l}function s(){return y.concat([])}function f(){for(;y.length>0;)n(y[0])}function v(){return"savedWorld<"+g+">"}var d,l,m=this,g="*",y=[];m.add=t,m.remove=n,m["export"]=e,m["import"]=r,m.save=o,m.load=i,m.isSaved=a,m.deleteSave=u,m.getScene=c,m.getVoxels=s,function(t,n){if(t===d)throw"World cannot be instantiated without a Scene instance";l=t,n!==d&&(g=n)}.apply(m,arguments)}voxelcss.World=t}(),function(){function t(){function t(){m=!0,c()}function n(){m=!1}function e(){return m}function r(){var t=new Image;return t.src=s[l],g.push(g),t}function o(t){g.push(t),t.src=s[l]}function i(t){var n=g.indexOf(t);-1!==n&&g.splice(n,1)}function a(){return f}function u(t){m=!0,l=Math.floor(t),setTimeout(c,(l+1-t)*v)}function c(){if(m){l+=1,l%=s.length;for(var t,n=0;t=g[n++];)t.src=s[l];setTimeout(c,v)}}var s,f,v,d=this,l=0,m=!1,g=[];d.run=t,d.stop=n,d.isRunning=e,d.getImage=r,d.attach=o,d.detach=i,d.getDuration=a,function(t,n){s=t,f=n,v=f/s.length;var e=Date.now()%f/v;u(e)}.apply(d,arguments)}voxelcss.SyncedGif=t}(),function(){function t(){function t(){Z=!0}function n(){Z=!1}function e(){return Z}function r(){D=!0}function o(){D=!1}function i(){return D}function a(){P.save()}function u(){var t=P.load();return L(),t}function c(){return P.isSaved()}function s(){return P.deleteSave()}function f(){return P["export"]()}function v(t){var n=P["import"](t);return L(),n}function d(t){y(t);var n=P.add(t);return D&&a(),n}function l(t){var n=P.remove(t);return n&&p(t),D&&a(),n}function m(){return P}function g(t){if(t===C)return M.mesh;var n=M.mesh;return M.mesh=t,n}function y(t){t.addEventListener("VoxelClick",x),t.addEventListener("TopClick",h),t.addEventListener("BottomClick",E),t.addEventListener("FrontClick",b),t.addEventListener("BackClick",w),t.addEventListener("LeftClick",z),t.addEventListener("RightClick",k)}function p(t){t.removeEventListener("VoxelClick",x),t.removeEventListener("TopClick",h),t.removeEventListener("BottomClick",E),t.removeEventListener("FrontClick",b),t.removeEventListener("BackClick",w),t.removeEventListener("LeftClick",z),t.removeEventListener("RightClick",k)}function x(t){if(Z){var n=t.target;l(n)}}function h(t){if(Z){var n=t.target;A(n,0,1,0)}}function E(t){if(Z){var n=t.target;A(n,0,-1,0)}}function b(t){if(Z){var n=t.target;A(n,0,0,1)}}function w(t){if(Z){var n=t.target;A(n,0,0,-1)}}function z(t){if(Z){var n=t.target;A(n,-1,0,0)}}function k(t){if(Z){var n=t.target;A(n,1,0,0)}}function A(t,n,e,r){var o=t.clone(),i=o.getDimension();o.setMesh(M.mesh),o.translate(n*i,e*i,r*i),d(o)}function L(){for(var t,n=0;t=P.getVoxels()[n++];)y(t)}var C,P,S=this,D=!1,Z=!0,M={mesh:{}};S.enable=t,S.disable=n,S.isEnabled=e,S.enableAutoSave=r,S.disableAutoSave=o,S.canAutoSave=i,S.save=a,S.load=u,S.isSaved=c,S.deleteSave=s,S["export"]=f,S["import"]=v,S.add=d,S.remove=l,S.getWorld=m,S.setToolMesh=g,function(t,n){if(t===C)throw"Editor requires World instance for initialization";P=t,n!==C&&n.autosave===!0&&r(),L()}.apply(S,arguments)}voxelcss.Editor=t}();